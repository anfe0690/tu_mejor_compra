<ui:composition template="../WEB-INF/layout/m/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:pm="http://primefaces.org/mobile">

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="pag" value="#{indexBean.navegacion.pagina}"/>
            <f:viewAction action="#{indexBean.buscarProductosRecientes}"/>
        </f:metadata>
    </ui:define>

    <ui:define name="css">
        <h:outputStylesheet name="css/m/index.css"/>
    </ui:define>

    <ui:define name="js">
        <h:outputScript name="js/m/index.js"/>
    </ui:define>

    <ui:define name="content">
        <pm:content styleClass="contenido-index">
            <h1>Productos recientes</h1>

            <ul data-role="listview" data-inset="true">
                <ui:repeat value="#{indexBean.productosRecientes}" var="producto">
                    <li class="producto-reciente ui-li-has-thumb">
                        <h:link outcome="producto.xhtml" includeViewParams="true">
                            <f:param name="pid" value="#{producto.id}"/>

                            <div class="cont-imagen">
                                <div><h:graphicImage value="/imgs/#{producto.direccionImagen}"/></div>
                            </div>

                            <h2>
                                <div><h:outputText value="#{producto.nombre}"/></div>
                            </h2>
                            <p><h:outputText value="#{producto.precio}"/> pesos</p>
                        </h:link>
                    </li>
                </ui:repeat>
            </ul>

            <!-- TODO MEJORA: Mejorar el control de navegacion entre paginas -->
            <div style="display: table; width: 100%; table-layout: fixed;" class="navegacion">
                <div style="display: table-cell;">
                    <h:link outcome="index.xhtml" includeViewParams="true" value="Anterior"
                            rendered="#{indexBean.navegacion.pagina.intValue() > 1}"
                            styleClass="ui-btn ui-corner-all ui-icon-arrow-l ui-btn-icon-left ui-mini">
                        <f:param name="pag" value="#{indexBean.navegacion.pagina.intValue() - 1}"/>
                    </h:link>
                </div>
                <div style="display: table-cell; width: 40px; text-align: center; vertical-align: middle ;font-weight: bold;">
                    <h:outputText
                            value="#{indexBean.navegacion.pagina.intValue()}"/></div>
                <div style="display: table-cell;">
                    <h:link outcome="index.xhtml" includeViewParams="true" value="Siguiente"
                            rendered="#{indexBean.navegacion.pagina.intValue() lt indexBean.navegacion.numeroPaginas.intValue()}"
                            styleClass="ui-btn ui-corner-all ui-icon-arrow-r ui-btn-icon-right ui-mini">
                        <f:param name="pag" value="#{indexBean.navegacion.pagina.intValue() + 1}"/>
                    </h:link>
                </div>
            </div>

        </pm:content>
    </ui:define>

</ui:composition>
