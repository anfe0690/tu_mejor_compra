<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

    <p:dialog header="Contraseñas" widgetVar="dialogoContrasenas">
        <div>andres = 123</div>
        <div>carlos = 456</div>
        <div>fernando = 789</div>
    </p:dialog>

    <p:dialog header="Iniciar sesion" widgetVar="dialogoIniciarSesion" styleClass="dialogo-sesion" modal="true"
              visible="#{not empty facesContext.getMessageList('form-sesion')}">
        <h:form id="form-sesion">
            <f:event type="postValidate" listener="#{sesionBean.validarUsuarioContrasena}"/>
            <p:message for="form-sesion"/>

            <p:panelGrid columns="2" styleClass="dialogo-sesion-grid" style="margin-top: 5px">
                <p:outputLabel for="nombre-usuario" value="Nombre"/>
                <p:inputText id="nombre-usuario" value="#{sesionBean.campoNombreUsuario}"/>

                <p:outputLabel for="contrasena-usuario" value="Contraseña"/>
                <p:password id="contrasena-usuario" value="#{sesionBean.campoContrasena}"/>
            </p:panelGrid>

            <p:watermark value="Nombre" for="nombre-usuario"/>
            <p:watermark value="Contraseña" for="contrasena-usuario"/>

            <p:commandButton value="Iniciar sesion" icon="ui-icon-person" ajax="false" action="#{sesionBean.iniciarSesion()}"
                             style="margin-right: 10px"/>
            <p:commandButton value="Contraseñas" icon="ui-icon-key" onclick="PF('dialogoContrasenas').show();" type="button"/>
        </h:form>
    </p:dialog>

    <p:panel styleClass="ui-widget-header pagina-seccion b-header">

        <div style="display: table; width: 100%">

            <div style="display: table-cell; vertical-align: middle; width: 210px">
                <h:link outcome="index.xhtml" title="Inicio">
                    <h:graphicImage name="logo.png" library="images" style="height: 40px;"/>
                </h:link>
            </div>

            <div style="display: table-cell; vertical-align: middle">
                <h:form>
                    <p:inputText id="campo-busqueda" value="#{headerBean.valor}" pt:required="required"
                                 style="margin-right: 10px; width: 200px"/>
                    <p:watermark value="Buscar producto" for="campo-busqueda"/>
                    <p:commandButton value="Buscar" ajax="false" icon="ui-icon-search"
                                     action="buscar.xhtml?faces-redirect=true&amp;includeViewParams=true">
                        <f:param name="valor" value="#{headerBean.valor}"/>
                    </p:commandButton>
                </h:form>
            </div>

            <div style="display: table-cell; vertical-align: middle; text-align: right;">

                <h:form>
                    <c:choose>
                        <c:when test="#{!sesionBean.sesionIniciada}">
                            <p:commandButton value="Iniciar sesion" icon="ui-icon-person" onclick="PF('dialogoIniciarSesion').show();"
                                             type="button"/>
                        </c:when>
                        <c:otherwise>
                            <h:outputText styleClass="usuario-nombre" value="#{sesionBean.usuario.nombre}"/>
                            <c:if test="#{facesContext.viewRoot.viewId != '/perfil.xhtml'}">
                                <p:link styleClass="link-perfil" outcome="perfil.xhtml" value="perfil"/>
                            </c:if>
                            <p:commandButton value="Cerrar sesion" icon="ui-icon-person" ajax="false"
                                             action="#{sesionBean.cerrarSesion()}"/>
                        </c:otherwise>
                    </c:choose>

                </h:form>

                <!--<h:form id="form-sesion" styleClass="form-sesion" style="display: inline-block">

                    <c:choose>
                        <c:when test="#{!sesionBean.sesionIniciada}">
                            <f:event type="postValidate" listener="#{sesionBean.validarUsuarioContrasena}"/>

                            <h:outputLabel for="nombre-usuario" value="Nombre"/>
                            <p:inputText id="nombre-usuario" value="#{sesionBean.campoNombreUsuario}"/>
                            <p:watermark value="Nombre" for="nombre-usuario"/>

                            <h:outputLabel for="contrasena-usuario" value="Contraseña"/>
                            <p:password id="contrasena-usuario" value="#{sesionBean.campoContrasena}"/>
                            <p:watermark value="Contraseña" for="contrasena-usuario"/>

                            <p:splitButton value="Iniciar sesion" icon="ui-icon-person" ajax="false" action="#{sesionBean.iniciarSesion()}">
                                <p:menuitem>
                                    <p:commandButton value="Contraseñas" icon="ui-icon-key" onclick="PF('dialogoContrasenas').show();"
                                                     type="button"
                                                     style="width: 100%; border-style: none"/>
                                </p:menuitem>
                            </p:splitButton>

                        </c:when>

                        <c:otherwise>
                            <h:outputText styleClass="usuario-nombre" value="#{sesionBean.usuario.nombre}"/>
                            <c:if test="#{view.viewId != '/perfil.xhtml'}">
                                <p:link styleClass="link-perfil" outcome="perfil.xhtml" value="perfil"/>
                            </c:if>
                            <p:commandButton value="Cerrar sesion" icon="ui-icon-person" ajax="false"
                                             action="#{sesionBean.cerrarSesion()}"/>
                        </c:otherwise>
                    </c:choose>

                </h:form>-->
            </div>
        </div>

    </p:panel>

</ui:composition>
